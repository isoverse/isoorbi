<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="An example for shot noise analysis.
">
<title>Shot Noise • isoorbi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Shot Noise">
<meta property="og:description" content="An example for shot noise analysis.
">
<meta property="og:image" content="https://isoorbi.isoverse.org/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light" data-bs-theme="default"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">isoorbi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/quick_start.html">Quick Start</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/shot_noise.html">Shot Noise</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/dual_inlet.html">Dual Inlet</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/flow_injection.html">Flow Injection</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/isoxl_demo.html">IsoXL demo GUI</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/isoverse/isoorbi">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Shot Noise</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/isoverse/isoorbi/blob/HEAD/vignettes/shot_noise.Rmd" class="external-link"><code>vignettes/shot_noise.Rmd</code></a></small>
      <div class="d-none name"><code>shot_noise.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/isoverse/isoorbi" class="external-link">isoorbi</a></span><span class="op">)</span> <span class="co"># for Orbitrap functions</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="co"># for data wrangling</span></span></code></pre></div>
<div class="section level2">
<h2 id="model-peptide-mrfa">Model Peptide (MRFA)<a class="anchor" aria-label="anchor" href="#model-peptide-mrfa"></a>
</h2>
<p>This is an example for shot-noise analysis from <a href="https://github.com/isoverse/2023_kantnerova_et_al" class="external-link">Kantnerová et
al. (2023)</a>.</p>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<div class="section level3">
<h3 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load and process data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> </span>
<span>  <span class="co"># load file included in isoorbi package</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"isoorbi"</span>, <span class="st">"extdata"</span>, <span class="st">"testfile_shotnoise.isox"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/orbi_read_isox.html">orbi_read_isox</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># check data for satellite peaks</span></span>
<span>  <span class="fu"><a href="../reference/orbi_flag_satellite_peaks.html">orbi_flag_satellite_peaks</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># make sure isotopocules are present in (almost) all scans, otherwise</span></span>
<span>  <span class="co"># shot noise analyses can be inaccurate</span></span>
<span>  <span class="fu"><a href="../reference/orbi_flag_weak_isotopocules.html">orbi_flag_weak_isotopocules</a></span><span class="op">(</span>min_percent <span class="op">=</span> <span class="fl">90</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># see if there are any AGC outliers</span></span>
<span>  <span class="fu"><a href="../reference/orbi_flag_outliers.html">orbi_flag_outliers</a></span><span class="op">(</span>agc_fold_cutoff <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>This indicates that there were a few satellite peaks and weak
isotopocules but no outliers.</p>
</div>
<div class="section level3">
<h3 id="visualize-isotopocule-coverage">Visualize isotopocule coverage<a class="anchor" aria-label="anchor" href="#visualize-isotopocule-coverage"></a>
</h3>
<p>Show the isotopocule coverage for the different amino acids, thus
highlighting which isotopocules were detected in which scans. Note that
2H was highlighted as weak for Alanine, Arginine, and Phenylalanine.
This is because of the high cutoff (90%) in
<code><a href="../reference/orbi_flag_weak_isotopocules.html">orbi_flag_weak_isotopocules()</a></code> which is appropriate for
shot-noise analyses but simply for inspecting ratios it would be
reasonable to examine the 2H signal at least for Alanine.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/orbi_plot_isotopocule_coverage.html">orbi_plot_isotopocule_coverage</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="shot_noise_files/figure-html/fig-mrfa-isotopocule-coverage-1.png" alt="Isotopocule coverage" width="768"><p class="caption">
Isotopocule coverage
</p>
</div>
</div>
<div class="section level3">
<h3 id="visualize-satellite-peaks">Visualize satellite peaks<a class="anchor" aria-label="anchor" href="#visualize-satellite-peaks"></a>
</h3>
<p>Show peaks that were flagged as satellite peaks.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/orbi_plot_satellite_peaks.html">orbi_plot_satellite_peaks</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="shot_noise_files/figure-html/fig-mrfa-satellite-peaks-1.png" alt="Satellite peaks" width="768"><p class="caption">
Satellite peaks
</p>
</div>
</div>
<div class="section level3">
<h3 id="visualize-intensity-vs-time">Visualize intensity vs time<a class="anchor" aria-label="anchor" href="#visualize-intensity-vs-time"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/orbi_plot_raw_data.html">orbi_plot_raw_data</a></span><span class="op">(</span></span>
<span>  isotopocules <span class="op">=</span> <span class="st">"M0"</span>, </span>
<span>  y <span class="op">=</span> <span class="va">intensity</span>,</span>
<span>  y_scale <span class="op">=</span> <span class="st">"log"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="shot_noise_files/figure-html/fig-mrfa-intensity-1.png" alt="Isotopocule intensity for M0 ion" width="768"><p class="caption">
Isotopocule intensity for M0 ion
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="shot-noise">Shot noise<a class="anchor" aria-label="anchor" href="#shot-noise"></a>
</h2>
<div class="section level3">
<h3 id="calculations">Calculations<a class="anchor" aria-label="anchor" href="#calculations"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate ratios vs basepeak</span></span>
<span><span class="va">data_w_bp</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/orbi_define_basepeak.html">orbi_define_basepeak</a></span><span class="op">(</span><span class="st">"M0"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate shot noise</span></span>
<span><span class="va">shot_noise</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">data_w_bp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/orbi_analyze_shot_noise.html">orbi_analyze_shot_noise</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># export shot noise to an Excel file</span></span>
<span><span class="va">shot_noise</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/orbi_export_data_to_excel.html">orbi_export_data_to_excel</a></span><span class="op">(</span><span class="st">"shot_noise.xlsx"</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="table">Table<a class="anchor" aria-label="anchor" href="#table"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example of the first few rows of the shot-noise calculations</span></span>
<span><span class="va">shot_noise</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">compound</span>, <span class="va">isotopocule</span>, <span class="va">scan.no</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">compound</span>, <span class="va">scan.no</span>, <span class="va">time.min</span>, <span class="va">isotopocule</span>,</span>
<span>         <span class="va">ratio</span>, <span class="va">ratio_rel_se.permil</span>, <span class="va">shot_noise.permil</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="10%">
<col width="9%">
<col width="10%">
<col width="13%">
<col width="11%">
<col width="23%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="left">compound</th>
<th align="right">scan.no</th>
<th align="right">time.min</th>
<th align="left">isotopocule</th>
<th align="right">ratio</th>
<th align="right">ratio_rel_se.permil</th>
<th align="right">shot_noise.permil</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Alanine</td>
<td align="right">1</td>
<td align="right">0.059</td>
<td align="left">15N</td>
<td align="right">0.0062453</td>
<td align="right">NaN</td>
<td align="right">73.71127</td>
</tr>
<tr class="even">
<td align="left">Alanine</td>
<td align="right">2</td>
<td align="right">0.102</td>
<td align="left">15N</td>
<td align="right">0.0060919</td>
<td align="right">12.43207</td>
<td align="right">52.42764</td>
</tr>
<tr class="odd">
<td align="left">Alanine</td>
<td align="right">3</td>
<td align="right">0.146</td>
<td align="left">15N</td>
<td align="right">0.0068807</td>
<td align="right">37.74616</td>
<td align="right">42.08467</td>
</tr>
<tr class="even">
<td align="left">Alanine</td>
<td align="right">4</td>
<td align="right">0.189</td>
<td align="left">15N</td>
<td align="right">0.0059526</td>
<td align="right">32.61878</td>
<td align="right">36.78579</td>
</tr>
<tr class="odd">
<td align="left">Alanine</td>
<td align="right">5</td>
<td align="right">0.233</td>
<td align="left">15N</td>
<td align="right">0.0060549</td>
<td align="right">26.57095</td>
<td align="right">32.90351</td>
</tr>
<tr class="even">
<td align="left">Alanine</td>
<td align="right">6</td>
<td align="right">0.277</td>
<td align="left">15N</td>
<td align="right">0.0055040</td>
<td align="right">29.99353</td>
<td align="right">30.32862</td>
</tr>
<tr class="odd">
<td align="left">Alanine</td>
<td align="right">7</td>
<td align="right">0.320</td>
<td align="left">15N</td>
<td align="right">0.0060244</td>
<td align="right">25.50106</td>
<td align="right">28.18264</td>
</tr>
<tr class="even">
<td align="left">Alanine</td>
<td align="right">8</td>
<td align="right">0.364</td>
<td align="left">15N</td>
<td align="right">0.0065182</td>
<td align="right">23.43771</td>
<td align="right">26.31067</td>
</tr>
<tr class="odd">
<td align="left">Alanine</td>
<td align="right">9</td>
<td align="right">0.408</td>
<td align="left">15N</td>
<td align="right">0.0064846</td>
<td align="right">21.36449</td>
<td align="right">24.76418</td>
</tr>
<tr class="even">
<td align="left">Alanine</td>
<td align="right">10</td>
<td align="right">0.451</td>
<td align="left">15N</td>
<td align="right">0.0061980</td>
<td align="right">19.10467</td>
<td align="right">23.50447</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="visualize-ratios-vs-time">Visualize ratios vs time<a class="anchor" aria-label="anchor" href="#visualize-ratios-vs-time"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_w_bp</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/orbi_plot_raw_data.html">orbi_plot_raw_data</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ratio</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="shot_noise_files/figure-html/fig-mrfa-ratios-1.png" alt="Isotopocule ratios vs M0" width="768"><p class="caption">
Isotopocule ratios vs M0
</p>
</div>
</div>
<div class="section level3">
<h3 id="visualize-shot-noise">Visualize shot noise<a class="anchor" aria-label="anchor" href="#visualize-shot-noise"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shot_noise</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/orbi_plot_shot_noise.html">orbi_plot_shot_noise</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="shot_noise_files/figure-html/fig-mrfa-shotnoise-1.png" alt="amino acids shotnoise" width="768"><p class="caption">
amino acids shotnoise
</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Caj Neubauer, Sebastian Kopf, Kristýna Kantnerová.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
