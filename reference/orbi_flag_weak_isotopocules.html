<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Flag weak isotopocules — orbi_flag_weak_isotopocules • isoorbi</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Flag weak isotopocules — orbi_flag_weak_isotopocules"><meta name="description" content="This function flags isotopocules that are not detected in a minimum of min_percent of scans that then can be easily visualized with orbi_plot_isotopocule_coverage().
It evaluates weak isotopocules within each &quot;uidx&quot;, &quot;filename&quot;, &quot;block&quot;, &quot;segment&quot; and &quot;injection&quot; (for those of the columns that exist),
in addition to any groupings already defined before calling this function using dplyr's group_by(). It restores the original groupings in the returned data."><meta property="og:description" content="This function flags isotopocules that are not detected in a minimum of min_percent of scans that then can be easily visualized with orbi_plot_isotopocule_coverage().
It evaluates weak isotopocules within each &quot;uidx&quot;, &quot;filename&quot;, &quot;block&quot;, &quot;segment&quot; and &quot;injection&quot; (for those of the columns that exist),
in addition to any groupings already defined before calling this function using dplyr's group_by(). It restores the original groupings in the returned data."><meta property="og:image" content="https://isoorbi.isoverse.org/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">isoorbi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.5.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html#show-me-some-code">Quick Start</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/functionality_guide.html">Functionality Guide</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples"><li><h6 class="dropdown-header" data-toc-skip>Isoorbi package</h6></li>
    <li><a class="dropdown-item" href="../articles/dual_inlet.html">Dual inlet analysis</a></li>
    <li><a class="dropdown-item" href="../articles/flow_injection.html">Flow injection analysis</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Kantnerová et al. 2024</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.isoverse.org/2024_kantnerova_et_al/shot_noise.html">Shot noise analysis</a></li>
    <li><a class="external-link dropdown-item" href="https://www.isoverse.org/2024_kantnerova_et_al/replicates.html">Replicates analysis</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/isoverse/isoorbi"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Flag weak isotopocules</h1>
      <small class="dont-index">Source: <a href="https://github.com/isoverse/isoorbi/blob/main/R/processing.R" class="external-link"><code>R/processing.R</code></a></small>
      <div class="d-none name"><code>orbi_flag_weak_isotopocules.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function flags isotopocules that are not detected in a minimum of <code>min_percent</code> of scans that then can be easily visualized with <code><a href="orbi_isotopocule_coverage.html">orbi_plot_isotopocule_coverage()</a></code>.
It evaluates weak isotopocules within each "uidx", "filename", "block", "segment" and "injection" (for those of the columns that exist),
in addition to any groupings already defined before calling this function using dplyr's <code>group_by()</code>. It restores the original groupings in the returned data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">orbi_flag_weak_isotopocules</span><span class="op">(</span><span class="va">dataset</span>, min_percent <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a></dt>
<dd><p>A simplified IsoX data frame to be processed</p></dd>


<dt id="arg-min-percent">min_percent<a class="anchor" aria-label="anchor" href="#arg-min-percent"></a></dt>
<dd><p>A number between 0 and 100 (inclusive). Isotopocule must be observed in at least this percentage of scans (please note: the percentage
is defined relative to the most commonly observed isotopocule of each compound). The default is 100, the most stringent condition to ensure reliable
isotpocule coverage and ratio calculations across data blocks. If you lower the default, be mindful of potential misinterprations from using isotopotcules
that are very close to their detection limit within a datablock. For continuous flow operations it may be necessary to make data blocks smaller using
<code><a href="orbi_define_block_for_flow_injection.html">orbi_define_block_for_flow_injection()</a></code> and <code><a href="orbi_adjust_block.html">orbi_adjust_block()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>same object as provided in <code>dataset</code> with new column <code>is_weak_isotopocule</code> that flags weak isotopocules.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"testfile_flow.isox"</span>, package <span class="op">=</span> <span class="st">"isoorbi"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="orbi_read_isox.html">orbi_read_isox</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">fpath</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="orbi_simplify_isox.html">orbi_simplify_isox</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>      <span class="fu">orbi_flag_weak_isotopocules</span><span class="op">(</span>min_percent <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> <span style="color: #B2B2B2;">[22ms]</span> <span style="font-weight: bold;">orbi_read_isox()</span> loaded 6449 peaks for 1 compound (<span style="color: #00BB00;">HSO4-</span>) with 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> isotopocules (<span style="color: #00BB00;">M0</span>, <span style="color: #00BB00;">33S</span>, <span style="color: #00BB00;">17O</span>, <span style="color: #00BB00;">34S</span>, and <span style="color: #00BB00;">18O</span>) from <span style="color: #0000BB;">testfile_flow.isox</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> <span style="color: #B2B2B2;">[5ms]</span> <span style="font-weight: bold;">orbi_simplify_isox()</span> kept columns <span style="color: #00BB00;">filepath</span>, <span style="color: #00BB00;">filename</span>, <span style="color: #00BB00;">scan.no</span>,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">time.min</span>, <span style="color: #00BB00;">compound</span>, <span style="color: #00BB00;">isotopocule</span>, <span style="color: #00BB00;">ions.incremental</span>, <span style="color: #00BB00;">tic</span>, and <span style="color: #00BB00;">it.ms</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> <span style="color: #B2B2B2;">[34ms]</span> <span style="font-weight: bold;">orbi_flag_weak_isotopocules()</span> flagged 1 of 15 isotopocules as <span style="color: #BBBB00;">weak</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> because they were NOT present in at least 100% of scans in each of the 15 data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> groups (based on <span style="color: #00BB00;">filename</span>, <span style="color: #00BB00;">compound</span>, and <span style="color: #00BB00;">isotopocule</span>) → use</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">orbi_plot_isotopocule_coverage()</span> to visualize them</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Caj Neubauer, Sebastian Kopf, Kristýna Kantnerová.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

